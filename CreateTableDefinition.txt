ALTER PROCEDURE [dbo].[usp_Dev_GetTableDefinition]
@TableName AS NVARCHAR(100)
AS
BEGIN
	SELECT DISTINCT
		C.ORDINAL_POSITION AS 'Sr.No.',
		--C.TABLE_NAME 'Table Name',
		C.COLUMN_NAME AS 'Column Name',
			CASE ISNULL((SELECT TCU.COLUMN_NAME
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE TCU
				WHERE OBJECTPROPERTY(OBJECT_ID(constraint_name), 'IsPrimaryKey') = 1
				AND TCU.TABLE_NAME = @TableName),'') WHEN C.COLUMN_NAME THEN 'YES' ELSE '' END AS 'Primary Key',
			CASE ISNULL((SELECT TCU.COLUMN_NAME
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE TCU
				WHERE OBJECTPROPERTY(OBJECT_ID(CONSTRAINT_NAME), 'IsForeignKey') = 1
				AND TCU.COLUMN_NAME = C.COLUMN_NAME
				AND TCU.TABLE_NAME = @TableName),'') WHEN C.COLUMN_NAME THEN 'YES' ELSE '' END AS 'Foreign Key',
		C.DATA_TYPE AS 'Data type',
		C.IS_NULLABLE AS 'Allow Null',
		ISNULL(C.COLUMN_DEFAULT,'') AS 'Default Value',
		ISNULL(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR),'') AS 'Max Length',
		CASE C.DATA_TYPE WHEN 'Decimal' THEN '(' + CONVERT(VARCHAR,C.NUMERIC_PRECISION) + ',' + CONVERT(VARCHAR,C.NUMERIC_SCALE) + ')' ELSE '' END AS 'Precision',
		ISNULL((SELECT VALUE FROM fn_listextendedproperty('MS_DESCRIPTION','schema','dbo','table',@TableName,'column',null) INNER JOIN INFORMATION_SCHEMA.COLUMNS CC on objname collate SQL_Latin1_General_CP1_CI_AS = CC.COLUMN_NAME collate SQL_Latin1_General_CP1_CI_AS AND CC.COLUMN_NAME = C.COLUMN_NAME AND CC.TABLE_NAME = @TableName),'') AS 'Description'
	FROM INFORMATION_SCHEMA.COLUMNS C
	WHERE C.TABLE_NAME = @TableName
END